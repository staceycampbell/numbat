#!/bin/bash
(cd misc && make fenconv)
fenmoves=/tmp/fenmoves$$
fenpgn=/tmp/fenpgn$$
fenmove=/tmp/fenmove$$
gameno=`shuf -i 1-13033 -n 1`
pgn-extract -Wfen --minmoves 2 --selectonly $gameno misc/GriffySr.pgn 2>/dev/null > $fenpgn
egrep '^[a-z]|^[1-8]' $fenpgn > $fenmoves
movecount=`wc -l < $fenmoves`
movecount=`expr $movecount - 1`
moveno=`shuf -i 1-$movecount -n 1`
tail -n+$moveno < $fenmoves | head -n1 > $fenmove
cat $fenmove
misc/fenconv < $fenmove > amt_board.vh
make amt
./amt
rm -f $fenmoves $fenpgn $fenmove
